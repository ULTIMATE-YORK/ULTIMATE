#Generate a Docker image for Ultimate Model Manager
#Usage: ./buildDockerImage.sh <tag_name>
#Example: ./buildDockerImage.sh ultimate_model_manager:latest
#!/bin/bash

name: Build and Push Docker Image

on:
  push:
    branches:
      - dockerFeature  # Occurs on pushes to the dockerFeature branch

jobs:
	  build-and-push:
			runs-on: ubuntu-latest

	steps:
		- name: Checkout repository
		  uses: actions/checkout@v4

		- name: Log in to GitHub Container Registry
		  uses: docker/login-action@v2
		  with:
			registry: ghcr.io
			username: ${{ github.actor }}
			password: ${{ secrets.GITHUB_TOKEN }} --password-stdin
		
		- name: Check if Dockerfile exists
		  run: |
			if [ ! -f ULTIMATE_MODEL_MANAGER/Dockerfile ]; then
			  echo "Dockerfile not found!"
			  exit 1
			fi
		
		- name: Build Docker Image
		  run: |
			docker build -t ghcr.io/${{ github.repository }}/ultimate_model_manager:latest -f ULTIMATE_MODEL_MANAGER/Dockerfile .
		
		- name: Push Docker Image to GitHub Container Registry
		  run: docker push ghcr.io/${{ github.repository }}/ultimate_model_manager:latest